<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>My Personal Blog</title>
    <description>This blog is an attempt to dive into personal blogging related to software development.
</description>
    <link>https://mogikanen9.github.io/</link>
    <atom:link href="https://mogikanen9.github.io/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Thu, 26 Jan 2017 22:39:17 -0500</pubDate>
    <lastBuildDate>Thu, 26 Jan 2017 22:39:17 -0500</lastBuildDate>
    <generator>Jekyll v3.2.1</generator>
    
      <item>
        <title>Configure Shibboleth SP on macOS Sierra</title>
        <description>&lt;h2 id=&quot;software&quot;&gt;Software&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://shibboleth.net/products/service-provider.html&quot;&gt;Shibboleth SP&lt;/a&gt; - Service Provider software to which allows to configure SSO-enabled web-sites/web-applications.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://httpd.apache.org/&quot;&gt;Apache Web Server&lt;/a&gt; - web server which will be used to expose our web sites and enable SSO for them. Shibboleth SP can integrate with either Apache or IIS - it cannot work standalone.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.macports.org/&quot;&gt;MacPorts&lt;/a&gt; - tool which allows installing different kind of Open Source software on you Mac. MacPorts is a legacy tool - &lt;a href=&quot;http://brew.sh/&quot;&gt;HomeBrew&lt;/a&gt; is a much better, easy to use, modern tool. Unfortunately, ShibbolethSP package right now (Dec 2016) is assembled for Mac Ports only.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://docs.oracle.com/javadb/10.6.2.1/adminguide/cadminsslkeys.html&quot;&gt;JDK keytool&lt;/a&gt; - utility which comes with Oracle JDK and allows creating private keys, self-signed, certs, public certs, key stores, etc. It can be considered as an alternative of &lt;a href=&quot;https://www.openssl.org/&quot;&gt;OpenSSL&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;installation-steps&quot;&gt;Installation steps&lt;/h2&gt;

&lt;h3 id=&quot;install-shibboleth-sp&quot;&gt;1. Install Shibboleth SP&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Download and install MacPorts from &lt;a href=&quot;https://www.macports.org/install.php&quot;&gt;https://www.macports.org/install.php&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Install Shibboleth SP using instructions from &lt;a href=&quot;https://wiki.shibboleth.net/confluence/display/SHIB2/NativeSPMacPortInstallation&quot;&gt;NativeSPMacPortInstallation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h3 id=&quot;create-private-key-and-public-cert&quot;&gt;2. Create Private key and Public Cert&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Create self-signed certificate:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;keytool -genkey -keyalg RSA -alias local-dev -keystore local-dev.jks -validity 365 -keysize 2048
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Export public certificate:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;keytool -export -keystore local-dev.jks -alias local-dev -file local-dev.cer
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Export private key:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;keytool -importkeystore -srckeystore local-dev.jks -destkeystore local-dev.p12 -deststoretype PKCS12
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As a result we got  a pare of public cert and private key which we can use for SSL on Apache.&lt;/p&gt;

&lt;hr /&gt;
&lt;h3 id=&quot;configure-apache&quot;&gt;3. Configure Apache&lt;/h3&gt;

&lt;p&gt;Apache2 on macOS configuration files are located at &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/apache2&lt;/code&gt;. By default only http is available and default port is 80.&lt;/p&gt;

&lt;h4 id=&quot;configure-virtual-host&quot;&gt;3.1 Configure Virtual Host&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;Uncomment line &lt;code class=&quot;highlighter-rouge&quot;&gt;Include conf/extra/httpd-vhosts.conf&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/apache2/httpd.conf&lt;/code&gt; (Apache config file)&lt;/li&gt;
  &lt;li&gt;Create virtual host by updating httpd-vhosts.conf config file:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &amp;lt;VirtualHost *:80&amp;gt;
   ServerAdmin webmaster@sp.mogikanensoftware.com
   DocumentRoot &quot;/Library/WebServer/Documents/sp.mogikanensoftware.com&quot;
   ServerName sp.mogikanensoftware.com
   ServerAlias www.sp.mogikanensoftware.com
   ErrorLog &quot;/private/var/log/apache2/sp.mogikanensoftware.com-error_log&quot;
   CustomLog &quot;/private/var/log/apache2/sp.mogikanensoftware.com-access_log&quot; common
  &amp;lt;/VirtualHost&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Create folder &lt;code class=&quot;highlighter-rouge&quot;&gt;sp.mogikanensoftware.com&lt;/code&gt; for virtual host at &lt;code class=&quot;highlighter-rouge&quot;&gt;/Library/WebServer/Documents/&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;Create directory &lt;code class=&quot;highlighter-rouge&quot;&gt;secure&lt;/code&gt; inside folder &lt;code class=&quot;highlighter-rouge&quot;&gt;/Library/WebServer/Documents/sp.mogikanensoftware.com&lt;/code&gt;. It will be the secured zone;&lt;/li&gt;
  &lt;li&gt;Place one index.html inside both root folder of virtual host and &lt;code class=&quot;highlighter-rouge&quot;&gt;secure&lt;/code&gt; folder.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;configure-ssl&quot;&gt;3.2 Configure SSL&lt;/h4&gt;
&lt;p&gt;Will use previously created private and public key for SSL.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Copy files &lt;code class=&quot;highlighter-rouge&quot;&gt;local-dev.cer&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;local-dev.p12&lt;/code&gt; to folder &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/apache2&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Rename public cert file &lt;code class=&quot;highlighter-rouge&quot;&gt;local-dev.cer&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;server.crt&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;Rename private key file &lt;code class=&quot;highlighter-rouge&quot;&gt;local-dev.p12&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;server.key&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;Add/or uncomment 2 Apache plugins/mods in &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/apache2/httpd.conf&lt;/code&gt;:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LoadModule socache_shmcb_module libexec/apache2/mod_socache_shmcb.so
LoadModule ssl_module libexec/apache2/mod_ssl.so
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Uncomment line &lt;code class=&quot;highlighter-rouge&quot;&gt;Include /private/etc/apache2/extra/httpd-ssl.conf&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/apache2/httpd.conf&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Update &lt;code class=&quot;highlighter-rouge&quot;&gt;httpd-ssl.conf&lt;/code&gt; config to configure SSL for the virtual host:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DocumentRoot &quot;/Library/WebServer/Documents/sp.mogikanensoftware.com&quot;
ServerName sp.mogikanensoftware.com:443
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Please, verify and confirm that the following lines are uncommented and point to the correct files (our key and cert):&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SSLCertificateFile &quot;/private/etc/apache2/server.crt&quot;
SLCertificateKeyFile &quot;/private/etc/apache2/server.key&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;configure-shibboleth-pluginmod&quot;&gt;3.3 Configure Shibboleth plugin/mod&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;Create folder &lt;code class=&quot;highlighter-rouge&quot;&gt;shibboleth-conf&lt;/code&gt; inside &lt;code class=&quot;highlighter-rouge&quot;&gt;/private/etc/apache2/extra/&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;Locate Shibboleth SP installed folder: &lt;code class=&quot;highlighter-rouge&quot;&gt;/opt/local/etc/shibboleth&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;Copy &lt;code class=&quot;highlighter-rouge&quot;&gt;apache24.config&lt;/code&gt; file from Shibboleth SP folder to folder &lt;code class=&quot;highlighter-rouge&quot;&gt;/private/etc/apache2/extra/shibboleth-conf&lt;/code&gt;;&lt;/li&gt;
  &lt;li&gt;Enable Shibboleth SP and Apache integration:&lt;/li&gt;
  &lt;li&gt;Modify file &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/apache2/httpd.conf&lt;/code&gt; - add line:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  Include /private/etc/apache2/extra/shibboleth-conf/apache24.config
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Enable Shibboleth SP plugin/mod by adding the following line to &lt;code class=&quot;highlighter-rouge&quot;&gt;apache24.config&lt;/code&gt;:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  LoadModule mod_shib /opt/local/lib/shibboleth/mod_shib_24.so
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;hr /&gt;
&lt;h3 id=&quot;configure-shibboleth-sp&quot;&gt;4. Configure Shibboleth SP&lt;/h3&gt;
&lt;p&gt;It’s not a simple task to fully properly configure Shibboleth SP. A very basic example of such configuration is below:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Add/configure host in Request Mapper section:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;RequestMapper type=&quot;Native&quot;&amp;gt;
  &amp;lt;RequestMap&amp;gt;
    &amp;lt;Host name=&quot;sp.mogikanensoftware.com&quot; scheme=&quot;http&quot;&amp;gt;
      &amp;lt;Path name=&quot;secure&quot; authType=&quot;shibboleth&quot; requireSession=&quot;true&quot;
        forceAuthn=&quot;true&quot; /&amp;gt;
    &amp;lt;/Host&amp;gt;
  &amp;lt;/RequestMap&amp;gt;
&amp;lt;/RequestMapper&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Configure/modify Application Defaults to use our SP:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &amp;lt;ApplicationDefaults entityID=&quot;https://sp.mogikanensoftware.com/Shibboleth.sso&quot;
		REMOTE_USER=&quot;eppn persistent-id targeted-id&quot;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Configure the appropriate Identity Provider:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;Specify IdP/SSO entityID:&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &amp;lt;SSO entityID=&quot;http://eumadfsdev.extranetusermanager.com/adfs/services/trust&quot;&amp;gt;
    SAML2 SAML1
  &amp;lt;/SSO&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Configure IdP/SSO metadata:&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &amp;lt;MetadataProvider type=&quot;XML&quot; file=&quot;FederationMetadata.xml&quot;&amp;gt;
  &amp;lt;/MetadataProvider&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Configure &lt;code class=&quot;highlighter-rouge&quot;&gt;CredentialResolver&lt;/code&gt; using private key and public certs created using &lt;code class=&quot;highlighter-rouge&quot;&gt;keytool&lt;/code&gt; in step #2 at the very beginning
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;!-- Simple file-based resolver for using a single keypair. --&amp;gt;
&amp;lt;CredentialResolver type=&quot;File&quot; key=&quot;omd-local-dev.p12&quot; certificate=&quot;omd-local-dev.cer&quot;/&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Start/or restart Apache:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./apachectl start
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
    &lt;p&gt;or&lt;/p&gt;
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./apachectl restart
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Start Shibboleth SP daemon:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;launchctl load -F /Library/LaunchDaemons/org.macports.shibd.plist
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Generate your SP Metadata file by hitting &lt;a href=&quot;http://sp.mogikanensoftware.com/Shibboleth.sso/Metadata&quot;&gt;http://sp.mogikanensoftware.com/Shibboleth.sso/Metadata&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Share your SP Metadata file with your Identity Provider&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h3 id=&quot;final-steps&quot;&gt;5. Final steps&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Confirm that the Identity Provider (SSO) your SP points to has successfully imported your SP Metadata;&lt;/li&gt;
  &lt;li&gt;Open public content of your virtual sites - &lt;a href=&quot;https://sp.mogikanensoftware.com/index.html&quot;&gt;https://sp.mogikanensoftware.com/index.html&lt;/a&gt;. You should get the page without any security handling;&lt;/li&gt;
  &lt;li&gt;Open/try to access secured page - &lt;a href=&quot;https://sp.mogikanensoftware.com/secure/index.html&quot;&gt;https://sp.mogikanensoftware.com/secure/index.html&lt;/a&gt;. You should be redirected to your Identity Provider Authentication process (login page);&lt;/li&gt;
  &lt;li&gt;Authenticate at your IdP. You will be redirected to your secured page;&lt;/li&gt;
  &lt;li&gt;Congratulations! We are done!&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;h3 id=&quot;additional-notes&quot;&gt;Additional notes&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;The above  describe a simplified way of configuration;&lt;/li&gt;
  &lt;li&gt;In reality there might be multiple virtual sites,  multiple Identity Providers, etc.&lt;/li&gt;
  &lt;li&gt;It’s highly recommended to read the official &lt;a href=&quot;https://wiki.shibboleth.net/confluence/display/SHIB2&quot;&gt;Shibboleth SP documentation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;!-- Universal Code for Disqus  --&gt;
&lt;div id=&quot;disqus_thread&quot;&gt;&lt;/div&gt;
&lt;script&gt;
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//https-mogikanen9-github-io.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
&lt;/script&gt;

&lt;noscript&gt;Please enable JavaScript to view the &lt;a href=&quot;https://disqus.com/?ref_noscript&quot; rel=&quot;nofollow&quot;&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;

</description>
        <pubDate>Wed, 28 Dec 2016 10:15:49 -0500</pubDate>
        <link>https://mogikanen9.github.io/apache/shibboleth/2016/12/28/configure-shibboleth-sp-on-mac.html</link>
        <guid isPermaLink="true">https://mogikanen9.github.io/apache/shibboleth/2016/12/28/configure-shibboleth-sp-on-mac.html</guid>
        
        
        <category>apache</category>
        
        <category>shibboleth</category>
        
      </item>
    
      <item>
        <title>My First Steps with HAPI. Part 2. Parsing HL7 message.</title>
        <description>&lt;p&gt;This post is a second part of my introduction into HAPI library.&lt;/p&gt;

&lt;h3 id=&quot;parse-hl7-message&quot;&gt;Parse HL7 message&lt;/h3&gt;

&lt;p&gt;We will start with a simple project which will demonstrate how to parse HL7 messages using HAPI API.&lt;/p&gt;

&lt;h4 id=&quot;tools-and-libraries-will-use&quot;&gt;Tools and libraries will use&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;JDK 1.8&lt;/li&gt;
  &lt;li&gt;Maven&lt;/li&gt;
  &lt;li&gt;Eclipse (STS 3.8.1)&lt;/li&gt;
  &lt;li&gt;HAPI API v2.2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;HAPI has a very good &lt;a href=&quot;http://hl7api.sourceforge.net/devbyexample.html&quot;&gt;set of examples&lt;/a&gt;
which is a good starting point. Will use it as well - will jump right to section ‘Parsing Messages’.&lt;/p&gt;

&lt;h4 id=&quot;configuration-steps&quot;&gt;Configuration steps&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;Create empty Maven based project simple-hl7-parser using basic archetype;&lt;/li&gt;
  &lt;li&gt;Add HL7 dependencies:
    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;..........................
&amp;lt;properties&amp;gt;
      &amp;lt;hapi.version&amp;gt;2.2&amp;lt;/hapi.version&amp;gt;
  &amp;lt;/properties&amp;gt;
&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;ca.uhn.hapi&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;hapi-base&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;${hapi.version}&amp;lt;/version&amp;gt;
  &amp;lt;scope&amp;gt;compile&amp;lt;/scope&amp;gt;
&amp;lt;/dependency&amp;gt;
&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;ca.uhn.hapi&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;hapi-structures-v24&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;${hapi.version}&amp;lt;/version&amp;gt;
  &amp;lt;scope&amp;gt;compile&amp;lt;/scope&amp;gt;
&amp;lt;/dependency&amp;gt;
..........................
&lt;/code&gt;&lt;/pre&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Import project into the IDE.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Notes: HAPI library packs structures for different HL7 versions in different artifacts. In my case I will use/parse HL7v2.4 messages -  I only included ‘hapi-structures-v24’ artifact.&lt;/em&gt;&lt;/p&gt;

&lt;h4 id=&quot;coding&quot;&gt;Coding&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;Create an instance HapiContext&lt;/li&gt;
  &lt;li&gt;Create an instance of CanonicalModelClassFactory&lt;/li&gt;
  &lt;li&gt;Add/set CanonicalModelClassFactory to HapiContext&lt;/li&gt;
  &lt;li&gt;Get parser (PipeParser)&lt;/li&gt;
  &lt;li&gt;Parse message&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Below is a piece of sample code:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;HapiContext context = new DefaultHapiContext();

CanonicalModelClassFactory mcf = new CanonicalModelClassFactory(&quot;2.4&quot;);

context.setModelClassFactory(mcf);

PipeParser parser = context.getPipeParser();

ca.uhn.hl7v2.model.v24.message.ORU_R01 msg = (ca.uhn.hl7v2.model.v24.message.ORU_R01) parser.parse(message);
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;The following things immediately pops to our eyes:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;CanonicalModelClassFactory takes Hl7v2 specific version (2.4 in our case)&lt;/li&gt;
  &lt;li&gt;Parsing result is an instance of ORU_R01 class from package ca.uhn.hl7v2.model.v24.message&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Items above means that we need to know which HL7v2 message we expect to parse and each version has its own strict model.&lt;/p&gt;

&lt;!-- Universal Code for Disqus  --&gt;
&lt;div id=&quot;disqus_thread&quot;&gt;&lt;/div&gt;
&lt;script&gt;
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//https-mogikanen9-github-io.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
&lt;/script&gt;

&lt;noscript&gt;Please enable JavaScript to view the &lt;a href=&quot;https://disqus.com/?ref_noscript&quot; rel=&quot;nofollow&quot;&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;

</description>
        <pubDate>Tue, 04 Oct 2016 22:55:49 -0400</pubDate>
        <link>https://mogikanen9.github.io/java/hapi/2016/10/04/first-steps-with-hapi-p2.html</link>
        <guid isPermaLink="true">https://mogikanen9.github.io/java/hapi/2016/10/04/first-steps-with-hapi-p2.html</guid>
        
        
        <category>java</category>
        
        <category>hapi</category>
        
      </item>
    
      <item>
        <title>My First Steps with HAPI. Part 1. Introduction.</title>
        <description>&lt;p&gt;This post is an introduction into HAPI library.&lt;/p&gt;

&lt;h3 id=&quot;introduction&quot;&gt;Introduction&lt;/h3&gt;

&lt;p&gt;We are starting a new project in Healthcare integration domain. The core functionality can be described like “a service/application which accepts HL7v2 messages over HTTP, validates them, transforms into custom XML and delivers to the recipients via SFTP”. When I googled for “HL7v2 Java” - HAPI is the first thing which tops the results. What does it mean? Let’s start with some definitions:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Health_Level_7&quot;&gt;HL7&lt;/a&gt; stands for “Health Level 7”. It’s a standard which describes how to transfer different healthcare clinical data.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Health_Level_7#HL7_version_2&quot;&gt;HL7v2&lt;/a&gt; is a version of HL7 standard developed in 1989 and it is based on pipes &lt;code class=&quot;highlighter-rouge&quot;&gt;|&lt;/code&gt; and carets &lt;code class=&quot;highlighter-rouge&quot;&gt;^&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://hl7api.sourceforge.net/&quot;&gt;HAPI&lt;/a&gt; is a Java-based Hl7v2 parser library.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When I first heard about HL7v2 several years ago and reviewed HL7v2 messages it looked like a bad joke. Neither XML nor JSON, really? Well, 1989 - what else you can expect. On the other side the protocol is widely adopted and currently it is still the main workhorse in healthcare industry.&lt;/p&gt;

&lt;p&gt;First results of checking HAPI website:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;The latest stable version is 2.2 and the last published date is “2014-05-12”;&lt;/li&gt;
  &lt;li&gt;The site is hosted at &lt;a href=&quot;https://sourceforge.net/&quot;&gt;sourceforge.net&lt;/a&gt;;&lt;/li&gt;
  &lt;li&gt;The library is built by &lt;a href=&quot;http://maven.apache.org/&quot;&gt;Maven&lt;/a&gt;;&lt;/li&gt;
  &lt;li&gt;Lots of examples in &lt;a href=&quot;http://hl7api.sourceforge.net/devbyexample.html&quot;&gt;Developing using HAPI - By Example&lt;/a&gt; section;&lt;/li&gt;
  &lt;li&gt;Decently looking Documentation section with references to all HL7v2.1 - HL7v2.6 messages.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;First impression conclusion - legacy library for legacy protocol with its pros. and cons.&lt;/p&gt;

&lt;p&gt;Pros.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Open source;&lt;/li&gt;
  &lt;li&gt;Should be stable and well tested;&lt;/li&gt;
  &lt;li&gt;Decent documentation:&lt;/li&gt;
  &lt;li&gt;Decent community;&lt;/li&gt;
  &lt;li&gt;Maven based.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Cons:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;No Java 8 support;&lt;/li&gt;
  &lt;li&gt;Latest Spring Framework support is questionable;&lt;/li&gt;
  &lt;li&gt;Support in general is a grey area.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Well, let’s take next step.&lt;/p&gt;

&lt;p&gt;Looked really promising.&lt;/p&gt;

&lt;!-- Universal Code for Disqus  --&gt;
&lt;div id=&quot;disqus_thread&quot;&gt;&lt;/div&gt;
&lt;script&gt;
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//https-mogikanen9-github-io.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
&lt;/script&gt;

&lt;noscript&gt;Please enable JavaScript to view the &lt;a href=&quot;https://disqus.com/?ref_noscript&quot; rel=&quot;nofollow&quot;&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;

</description>
        <pubDate>Sun, 25 Sep 2016 22:55:49 -0400</pubDate>
        <link>https://mogikanen9.github.io/java/hapi/2016/09/25/first-steps-with-hapi.html</link>
        <guid isPermaLink="true">https://mogikanen9.github.io/java/hapi/2016/09/25/first-steps-with-hapi.html</guid>
        
        
        <category>java</category>
        
        <category>hapi</category>
        
      </item>
    
      <item>
        <title>Cobertura and JaCoCo: using test coverage plugin</title>
        <description>&lt;p&gt;Recently I decided to configure a test coverage plugin for one of my pet projects to have a better visibility of my unit tests. At work we use &lt;a href=&quot;http://www.sonarqube.org/&quot;&gt;SonarQube&lt;/a&gt; - too much for my purpose. I immediately looked at Cobertura and its &lt;a href=&quot;http://www.mojohaus.org/cobertura-maven-plugin/&quot;&gt;Maven plugin&lt;/a&gt;. Several years ago I setup Cobertura for couple of real projects at our CI server and it worked great. The setup was straightforward and I started to enjoy my test coverage report. My happy time was short - once I started to use lambdas (introduced in Java 8) extensively the plugin started to struggle with analysis. The plugin failed to check those classes and generated a errors like:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;java.lang.IllegalArgumentException: INVOKESPECIAL/STATIC on interfaces require ASM 5
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;I was using version 2.7 which supposed to support Java 8. Once googled I found that I am not the only one who is facing those issues. People reported same issues at their &lt;a href=&quot;https://github.com/cobertura/cobertura/issues/166&quot;&gt;GitHub page&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Dilemma: should I spent more time digging into it or try an alternative?&lt;/p&gt;

&lt;p&gt;I knew that SonarQube was using &lt;a href=&quot;http://www.eclemma.org/jacoco/&quot;&gt;JaCoCo&lt;/a&gt; and I also used Emma Eclipse plugin long time ago and it also worked quite well. Decided to try JaCoco. The setup was not as neat as for Cobertura plugin but I made it working and it worked perfectly with Java 8.&lt;/p&gt;

&lt;p&gt;The final Maven plugin configuration is below.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;build&amp;gt;
	...
  &amp;lt;plugin&amp;gt;
    &amp;lt;groupId&amp;gt;org.jacoco&amp;lt;/groupId&amp;gt;
    &amp;lt;artifactId&amp;gt;jacoco-maven-plugin&amp;lt;/artifactId&amp;gt;
    &amp;lt;version&amp;gt;0.7.7.201606060606&amp;lt;/version&amp;gt;
    &amp;lt;configuration&amp;gt;
      &amp;lt;destFile&amp;gt;${basedir}/target/coverage-reports/jacoco-unit.exec&amp;lt;/destFile&amp;gt;
      &amp;lt;dataFile&amp;gt;${basedir}/target/coverage-reports/jacoco-unit.exec&amp;lt;/dataFile&amp;gt;
      &amp;lt;/configuration&amp;gt;
        &amp;lt;executions&amp;gt;
          &amp;lt;execution&amp;gt;
            &amp;lt;id&amp;gt;jacoco-initialize&amp;lt;/id&amp;gt;
            &amp;lt;goals&amp;gt;
              &amp;lt;goal&amp;gt;prepare-agent&amp;lt;/goal&amp;gt;
            &amp;lt;/goals&amp;gt;
          &amp;lt;/execution&amp;gt;
          &amp;lt;execution&amp;gt;
            &amp;lt;id&amp;gt;jacoco-site&amp;lt;/id&amp;gt;
            &amp;lt;phase&amp;gt;package&amp;lt;/phase&amp;gt;
            &amp;lt;goals&amp;gt;
              &amp;lt;goal&amp;gt;report&amp;lt;/goal&amp;gt;
              &amp;lt;/goals&amp;gt;
          &amp;lt;/execution&amp;gt;
        &amp;lt;/executions&amp;gt;
      &amp;lt;/plugin&amp;gt;
    &amp;lt;/plugins&amp;gt;
    ...
&amp;lt;/build&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;!-- Universal Code for Disqus  --&gt;
&lt;div id=&quot;disqus_thread&quot;&gt;&lt;/div&gt;
&lt;script&gt;
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//https-mogikanen9-github-io.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
&lt;/script&gt;

&lt;noscript&gt;Please enable JavaScript to view the &lt;a href=&quot;https://disqus.com/?ref_noscript&quot; rel=&quot;nofollow&quot;&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;

</description>
        <pubDate>Fri, 23 Sep 2016 21:15:49 -0400</pubDate>
        <link>https://mogikanen9.github.io/jekyll/update/2016/09/23/select-test-coverage-plugin.html</link>
        <guid isPermaLink="true">https://mogikanen9.github.io/jekyll/update/2016/09/23/select-test-coverage-plugin.html</guid>
        
        
        <category>jekyll</category>
        
        <category>update</category>
        
      </item>
    
      <item>
        <title>Welcome to Jekyll!</title>
        <description>&lt;p&gt;You’ll find this post in your &lt;code class=&quot;highlighter-rouge&quot;&gt;_posts&lt;/code&gt; directory. Go ahead and edit it and re-build the site to see your changes. You can rebuild the site in many different ways, but the most common way is to run &lt;code class=&quot;highlighter-rouge&quot;&gt;jekyll serve&lt;/code&gt;, which launches a web server and auto-regenerates your site when a file is updated.&lt;/p&gt;

&lt;p&gt;To add new posts, simply add a file in the &lt;code class=&quot;highlighter-rouge&quot;&gt;_posts&lt;/code&gt; directory that follows the convention &lt;code class=&quot;highlighter-rouge&quot;&gt;YYYY-MM-DD-name-of-post.ext&lt;/code&gt; and includes the necessary front matter. Take a look at the source for this post to get an idea about how it works.&lt;/p&gt;

&lt;p&gt;Jekyll also offers powerful support for code snippets:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;print_hi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Hi, &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;print_hi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Tom'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#=&amp;gt; prints 'Hi, Tom' to STDOUT.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Check out the &lt;a href=&quot;http://jekyllrb.com/docs/home&quot;&gt;Jekyll docs&lt;/a&gt; for more info on how to get the most out of Jekyll. File all bugs/feature requests at &lt;a href=&quot;https://github.com/jekyll/jekyll&quot;&gt;Jekyll’s GitHub repo&lt;/a&gt;. If you have questions, you can ask them on &lt;a href=&quot;https://talk.jekyllrb.com/&quot;&gt;Jekyll Talk&lt;/a&gt;.&lt;/p&gt;

&lt;!-- Universal Code for Disqus  --&gt;
&lt;div id=&quot;disqus_thread&quot;&gt;&lt;/div&gt;
&lt;script&gt;
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//https-mogikanen9-github-io.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
&lt;/script&gt;

&lt;noscript&gt;Please enable JavaScript to view the &lt;a href=&quot;https://disqus.com/?ref_noscript&quot; rel=&quot;nofollow&quot;&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;

</description>
        <pubDate>Tue, 20 Sep 2016 21:50:49 -0400</pubDate>
        <link>https://mogikanen9.github.io/jekyll/update/2016/09/20/welcome-to-jekyll.html</link>
        <guid isPermaLink="true">https://mogikanen9.github.io/jekyll/update/2016/09/20/welcome-to-jekyll.html</guid>
        
        
        <category>jekyll</category>
        
        <category>update</category>
        
      </item>
    
  </channel>
</rss>
